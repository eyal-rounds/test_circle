machine:
  environment:
    BRANCH_WITH_COUNTER: develop
test:
  pre:
    - env|sort
    - cat ~/.rounds_cache/build_count

  override:
    - ./gradlew assembleRelease
    - cp -r app/build/outputs/* $CIRCLE_ARTIFACTS
dependencies:
  pre:
   - if [ -e ./gradlew ]; then ./gradlew updateVersionNameAndCounter;else gradle updateVersionNameAndCounter;fi  
  cache_directories:
    - ~/.rounds_cache/
deployment:
  production:
    branch: master
    commands:
      - ./scripts/deplot_to_s3.sh
  staging:
    branch: develop
    commands:
      - ./scripts/deploy_to_s3.sh
